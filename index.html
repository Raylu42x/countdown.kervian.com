<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Countdown</title>
<style>
:root {
  --bg: #0b0033;
  --gold: #facc15;
  --hot: #fde68a;
  --grey: #aaa;
}

* { box-sizing: border-box; font-family: system-ui, sans-serif; margin: 0; padding: 0; }

html, body { width: 100%; height: 100%; }

body {
  min-height: 100svh;
  background: radial-gradient(circle at top, #1a004d, var(--bg));
  color: var(--grey);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  overflow: hidden;
  padding:
    env(safe-area-inset-top)
    env(safe-area-inset-right)
    env(safe-area-inset-bottom)
    env(safe-area-inset-left);
}

canvas { position: fixed; inset: 0; pointer-events: none; }

.controls {
  position: fixed;
  bottom: 10px;
  opacity: 0.5;
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
  justify-content: center;
  transition: opacity 0.3s ease;
}

input, select {
  padding: 0.5rem 0.8rem;
  border-radius: 10px;
  border: none;
  font-weight: 700;
  color: var(--grey);
  background: rgba(255,255,255,0.08);
}

#countdown {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: clamp(0.5rem, 2vw, 2rem);
  width: 90vw;
  max-width: 1800px;
}

.box {
  background: rgba(255,255,255,0.05);
  padding: clamp(1rem, 3vw, 2rem);
  border-radius: 16px;
  backdrop-filter: blur(10px);
  transition: all 0.3s ease;
}

.box span {
  font-size: clamp(4rem, 15vw, 12rem);
  font-weight: 900;
  color: var(--gold);
  text-shadow: 0 0 16px rgba(250,204,21,0.7);
  transition: transform 0.3s ease;
}

#secondsOnly {
  display: none;
  font-size: clamp(5rem, 30vw, 15rem);
  font-weight: 900;
  color: var(--hot);
  text-shadow: 0 0 40px rgba(253,230,138,1);
  transition: transform 0.3s ease;
}

body.final-60 #secondsOnly { animation: pulse 0.6s infinite; }

@keyframes pulse { 0%,100%{transform:scale(1);} 50%{transform:scale(1.15);} }

@media(max-width:1200px){
  .box span{font-size:clamp(3rem,20vw,10rem);}
  #secondsOnly{font-size:clamp(4rem,25vw,12rem);}
}
</style>
</head>
<body>
<canvas id="fx"></canvas>

<div class="controls">
  <input type="date" id="date">
  <input type="time" id="time">
  <select id="tz">
    <option value="auto">Auto (Local)</option>
    <option value="0">UTC</option>
  </select>
</div>

<div id="countdown">
  <div class="box"><span id="h">0</span><div>Hours</div></div>
  <div class="box"><span id="m">0</span><div>Minutes</div></div>
  <div class="box"><span id="s">0</span><div>Seconds</div></div>
</div>

<div id="secondsOnly">0</div>

<script>
const dateInput=document.getElementById("date");
const timeInput=document.getElementById("time");
const tzSelect=document.getElementById("tz");
const hEl=document.getElementById("h"),
      mEl=document.getElementById("m"),
      sEl=document.getElementById("s"),
      secOnly=document.getElementById("secondsOnly"),
      grid=document.getElementById("countdown"),
      controls=document.querySelector(".controls");

const now=new Date();
dateInput.value=`${now.getFullYear()+1}-01-01`;
timeInput.value="00:00";

function getTarget(){
  if(!dateInput.value || !timeInput.value) return null;
  const [y,m,d]=dateInput.value.split("-").map(Number);
  const [hh,mm]=timeInput.value.split(":").map(Number);
  if(tzSelect.value==="auto") return new Date(y,m-1,d,hh,mm,0).getTime();
  return Date.UTC(y,m-1,d,hh - Number(tzSelect.value), mm,0);
}

let finished=false;
function update(){
  const target=getTarget();
  if(!target) return;
  let diff=Math.max(0, Math.floor((target-Date.now())/1000));
  const h=Math.floor(diff/3600);
  const m=Math.floor(diff/60)%60;
  const s=diff%60;

  hEl.textContent=h;
  mEl.textContent=m;
  sEl.textContent=s;

  if(diff<=60 && !finished){
    grid.style.display="none";
    controls.style.opacity=0.5;
    secOnly.style.display="block";
    secOnly.textContent=s;
    document.body.classList.add("final-60");
  }

  if(diff===0 && !finished){
    finished=true;
    secOnly.textContent="HAPPY NEW YEAR";
    // hide everything else
    grid.style.display="none";
    controls.style.opacity=0;
    // hide message after 5 seconds
    setTimeout(()=>{secOnly.style.display="none";},5000);
    bigFirework();
  }
}
setInterval(update,1000);
update();

// ---------- FIREWORKS ----------
const c=document.getElementById("fx"),ctx=c.getContext("2d");
let particles=[];
let colors=["#facc15","#fde68a","#ff4d4d","#4dff4d","#4d4dff","#ff4dff"];

function resize(){c.width=innerWidth;c.height=innerHeight;}
onresize=resize;resize();

function firework(x,y,color){
  for(let i=0;i<40;i++){
    const a=Math.random()*Math.PI*2;
    const v=Math.random()*2+1; // slow initial speed
    particles.push({x,y,vx:Math.cos(a)*v,vy:Math.sin(a)*v,life:60,color: color||colors[Math.floor(Math.random()*colors.length)]});
  }
}

function bigFirework(){
  for(let i=0;i<5;i++){
    firework(c.width/2 + (i*20-40), c.height/3 + (i*10-20));
  }
}

// slow initial fireworks, more as countdown approaches zero
setInterval(()=>{
  let target=getTarget();
  let t=target?Math.max(0,Math.floor((target-Date.now())/1000)):60;
  let count=1;
  if(t<=60) count=5;
  else if(t<=600) count=3;
  for(let i=0;i<count;i++){
    firework(Math.random()*c.width, Math.random()*c.height*0.5);
  }
},1200);

function draw(){
  ctx.clearRect(0,0,c.width,c.height);
  particles.forEach(p=>{
    p.x+=p.vx;
    p.y+=p.vy;
    p.vy+=0.02;
    p.life--;
    ctx.beginPath();
    ctx.arc(p.x,p.y,2,0,Math.PI*2);
    ctx.fillStyle=p.color;
    ctx.fill();
  });
  particles=particles.filter(p=>p.life>0);
  requestAnimationFrame(draw);
}
draw();
</script>
</body>
</html>
